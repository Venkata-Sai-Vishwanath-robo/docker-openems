import{a as fn}from"./chunk-NLFVUSHU.js";import{b as zt}from"./chunk-AE767NUV.js";import{b as Cn,c as hn}from"./chunk-U4AVYC7D.js";import{e as on,j as dn,k as te,l as pn,m as ee,n as un}from"./chunk-RQWSIHDL.js";import{a as Wt,b as sn,d as Ht,e as cn,f as Ct,g as mn}from"./chunk-GYAINRZU.js";import{$d as K,A as st,Aa as G,Ab as J,Ac as tt,Af as Zt,Ba as z,Bb as be,Bd as We,Ca as I,Cc as Ft,D as le,Da as h,Df as ln,E as y,Ea as a,F as b,Fa as O,Fc as Se,G as Xt,Ga as N,Gc as Qt,Gd as Gt,H as se,Hb as ht,Hc as ut,Hf as nt,Ia as ue,Id as He,Ja as fe,Jd as ze,K as Tt,Ka as _e,Kd as Ue,La as U,Lc as Ee,Ld as $e,M as Mt,Ma as T,Mb as Ie,Mc as Ne,N as k,Nc as Lt,O as ce,Oa as Q,Pa as Ce,Pb as Te,Pd as Ke,Qa as _,Ra as S,Rd as qe,S as me,Sa as v,Sc as ke,Sd as Xe,Td as Qe,Uc as Fe,Ue as Jt,V as r,Vc as Le,W as ct,Wc as De,Wd as Ye,Wf as j,Xc as Ae,Xd as Je,Xe as Rt,Yc as Ve,Za as St,Zc as Pe,ag as it,ba as u,bd as Be,be as Ze,bf as jt,c as It,cd as Dt,ce as at,cf as rn,da as f,db as he,dc as Et,dd as ft,dg as ot,ea as mt,ee as _t,eg as rt,fa as dt,fc as Me,fd as At,fe as tn,gc as we,gd as Vt,ge as en,ha as F,ia as L,id as Ge,ie as Yt,jb as w,jc as gt,jd as Oe,kb as X,kd as Pt,lb as $,ld as E,m as ae,ma as de,md as Re,mg as _n,nb as Y,oa as c,oe as Ot,pa as wt,pb as ge,pc as Nt,pd as je,qa as m,qb as R,qc as Z,qd as Bt,qe as nn,ra as pe,rb as ve,sa as H,sc as kt,ta as D,tb as xe,td as et,u as qt,ua as A,uf as an,va as d,wa as l,xa as s,ya as C,yc as pt,za as B,zb as ye}from"./chunk-UEHZAF3Y.js";import{g as P}from"./chunk-OQDXQ3X5.js";var vt=(function(e){return e.NO_FILTER=o=>!0,e.GRID_MODE_IS_OFF_GRID=o=>o===an.OFF_GRID,e.NOT_NULL_OR_UNDEFINED=o=>o!=null,e.HIDE_NEGATIVE_VALUES=o=>o<0,e})(vt||{});var xt=(()=>{class e{constructor(t,n,i,p,g){this.websocket=t,this.route=n,this.service=i,this.modalCtrl=p,this.dataService=g,this.filter=vt.NO_FILTER,this.displayValue=null,this.displayName=null,this.show=!0,this._channelAddress=null,this.selector=jt(),this.stopOnDestroy=new It,this.edge=null,this.injector=le(se),this.converter=M=>M}set name(t){typeof t=="object"?(this.subscribe(t.channel),this._name=t.converter):this._name=t}set channelAddress(t){this._channelAddress=rt.fromString(t),this.subscribe(rt.fromString(t))}ngOnChanges(){this.setValue(this.value)}ngOnDestroy(){this.stopOnDestroy.next(),this.stopOnDestroy.complete(),this.subscription?.destroy()}setValue(t){typeof this._name=="function"?this.displayName=this._name(t):this.displayName=this._name,this.displayValue=this.converter(t),this.filter&&(this.show=this.filter(t))}subscribe(t){this.service.getCurrentEdge().then(n=>{this.edge=n,this.dataService.getValues([t],this.edge),this.subscription=R(()=>{let i=this.dataService.currentValue();this.setValue(i.allComponents[t.toString()])},{injector:this.injector})})}static{this.\u0275fac=function(n){return new(n||e)(u(ot),u(Et),u(j),u(K),u(fn))}}static{this.\u0275dir=dt({type:e,inputs:{value:"value",filter:"filter",name:"name",channelAddress:"channelAddress",converter:"converter"},features:[Mt]})}}return e})();var kn=["*"];function Fn(e,o){if(e&1&&(Xt(),C(0,"rect",4)),e&2){let t=a();Q("width: calc("+t.displayPercent+"% - 4px); transition: width 0.5s ease-in-out;")}}var Bo=(()=>{class e extends xt{get displayPercent(){return this.displayValue===null?null:Math.round(Number.parseFloat(this.displayValue))}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=k(e)))(i||e)}})()}static{this.\u0275cmp=f({type:e,selectors:[["oe-flat-widget-percentagebar"]],standalone:!1,features:[F],ngContentSelectors:kn,decls:7,vars:5,consts:[["width","100%","height","24","overflow","visible"],["width","100%","rx","7.3","ry","7.3","height","22",2,"fill","var(--ion-background-percentagebar-color)"],["x","2","y","2","rx","6","ry","6","height","18",2,"fill","var(--ion-color-active-percentagebar)",3,"style"],["x","50%","y","50%","dominant-baseline","middle","text-anchor","middle",1,"percentage-style",2,"font-weight","500"],["x","2","y","2","rx","6","ry","6","height","18",2,"fill","var(--ion-color-active-percentagebar)"]],template:function(n,i){n&1&&(O(),Xt(),l(0,"svg",0),C(1,"rect",1),c(2,Fn,1,2,":svg:rect",2),l(3,"text",3),_(4),w(5,"unitvalue"),s(),N(6),s()),n&2&&(r(2),m(i.displayPercent?2:-1),r(2),v(" ",$(5,2,i.displayPercent,"%")," "))},dependencies:[Wt],encapsulation:2})}}return e})();var gn=(()=>{class e{constructor(t){this.elementRef=t,this.ngDomChange=new ct;let n=this.elementRef.nativeElement;this.changes=new MutationObserver(i=>{i.forEach(p=>this.ngDomChange.emit(p))}),this.changes.observe(n,{attributes:!0,childList:!0,characterData:!0})}static{this.\u0275fac=function(n){return new(n||e)(u(ce))}}static{this.\u0275dir=dt({type:e,selectors:[["","ngDomChange",""]],outputs:{ngDomChange:"ngDomChange"}})}}return e})();var An=[[["","button",""]],"*"],Vn=["[button]","*"];function Pn(e,o){if(e&1&&(l(0,"ion-avatar",5),C(1,"img",6),s()),e&2){let t=a();Ce("iconify"+(t.img.large?" icon-large":"")),r(),d("src",t.img.src,me)}}function Bn(e,o){if(e&1&&C(0,"ion-icon",3),e&2){let t=a();d("size",t.icon.size||"large")("color",t.icon.color||"primary")("name",t.icon.name)}}function Gn(e,o){if(e&1&&(l(0,"ion-label"),_(1),s()),e&2){let t=a();r(),S(t.title)}}var Wo=(()=>{class e{constructor(t,n){this.modalController=t,this.router=n,this.icon=null,this.link=null,this._modalComponent=null}set modalComponent(t){this._modalComponent=t}onCallback(){return P(this,null,function*(){if(this._modalComponent!=null)return yield(yield this.modalController.create({component:this._modalComponent.component,componentProps:this._modalComponent.componentProps})).present();if(this.link!=null){this.router.navigateByUrl(this.link);return}})}static{this.\u0275fac=function(n){return new(n||e)(u(K),u(Me))}}static{this.\u0275cmp=f({type:e,selectors:[["oe-flat-widget"]],inputs:{img:"img",icon:"icon",color:"color",title:"title",link:"link",modalComponent:"modalComponent"},standalone:!1,ngContentSelectors:Vn,decls:8,vars:3,consts:[["role","button","tabindex","0",2,"cursor","pointer",3,"keydown.enter","click"],["lines","full",2,"--background","var(--ion-background-color-card-header)"],["slot","start",3,"class"],["slot","start",3,"size","color","name"],[2,"--background","var(--ion-color-primary)"],["slot","start"],[3,"src"]],template:function(n,i){n&1&&(O(An),l(0,"ion-card",0),h("keydown.enter",function(){return i.onCallback()})("click",function(){return i.onCallback()}),l(1,"ion-item",1),c(2,Pn,2,3,"ion-avatar",2),c(3,Bn,1,3,"ion-icon",3),c(4,Gn,2,1,"ion-label"),N(5),s(),l(6,"ion-card-content",4),N(7,1),s()()),n&2&&(r(2),m(i.img?2:-1),r(),m(i.icon?3:-1),r(),m(i.title?4:-1))},dependencies:[ke,Ve,Pe,E,Bt,et],encapsulation:2})}}return e})();function On(e,o){e&1&&C(0,"div",0)}function Rn(e,o){if(e&1&&c(0,On,1,0,"div",0),e&2){let t=a();m(t.index!==t.components.length-1?0:-1)}}function jn(e,o){e&1&&C(0,"div",0)}var Uo=(()=>{class e{constructor(){this.components=null,this.index=null}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=f({type:e,selectors:[["oe-flat-widget-horizontal-line"]],inputs:{components:"components",index:"index"},standalone:!1,decls:2,vars:1,consts:[[2,"border-bottom","1px solid lightgray","width","110%","margin-top","2%","margin-bottom","2%","margin-left","-5%"]],template:function(n,i){n&1&&c(0,Rn,1,1)(1,jn,1,0,"div",0),n&2&&m(i.index!==null&&i.components!==null?0:1)},encapsulation:2})}}return e})();var Wn=["*"];function Hn(e,o){if(e&1&&_(0),e&2){let t=a(2);v(" ",t.displayName," ")}}function zn(e,o){if(e&1&&(l(0,"td",4),B(1),_(2),G(),s()),e&2){let t=a(2);T("width",(t.leftColumnWidth??35)+"%"),r(2),S(t.displayValue)}}function Un(e,o){e&1&&z(0)}function $n(e,o){if(e&1&&(l(0,"td",4),N(1),s()),e&2){let t=a(3);T("width",100-(t.leftColumnWidth??50)+"%")}}function Kn(e,o){if(e&1&&c(0,$n,2,2,"td",2),e&2){let t=a(2);m(t.displayValue?-1:0)}}function qn(e,o){if(e&1&&(l(0,"table",1)(1,"tr")(2,"td"),c(3,Hn,1,1),s(),c(4,zn,3,3,"td",2),L(5,Un,1,0,"ng-container",3)(6,Kn,1,1,"ng-template",null,0,Y),s()()),e&2){let t=U(7),n=a();r(2),T("width",(n.leftColumnWidth??65)+"%"),r(),m(n.displayName?3:-1),r(),m(n.displayValue?4:-1),r(),d("ngTemplateOutlet",t)}}var qo=(()=>{class e extends xt{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=k(e)))(i||e)}})()}static{this.\u0275cmp=f({type:e,selectors:[["oe-flat-widget-line"]],inputs:{leftColumnWidth:"leftColumnWidth"},standalone:!1,features:[F],ngContentSelectors:Wn,decls:1,vars:1,consts:[["contentTpl",""],[1,"full_width",2,"color","var(--ion-card-content) !important"],[1,"align_right",3,"width"],[4,"ngTemplateOutlet"],[1,"align_right"]],template:function(n,i){n&1&&(O(),c(0,qn,8,5,"table",1)),n&2&&m(i.show?0:-1)},dependencies:[J],encapsulation:2})}}return e})();function Xn(e,o){if(e&1&&(l(0,"span"),_(1),s()),e&2){let t=a(3);r(),v(" ",t.displayValues.comment," | ")}}function Qn(e,o){if(e&1&&(l(0,"a",4),_(1),w(2,"version"),s()),e&2){let t=a(3);d("routerLink",St("/device/",t.edge.id,"/settings/system")),r(),v(" Version ",$(2,3,t.displayValues.version,o)," ")}}function Yn(e,o){if(e&1&&(B(0,1),l(1,"ion-grid",2)(2,"ion-row")(3,"ion-col",3),c(4,Xn,2,1,"span"),l(5,"span"),_(6),s(),_(7," | "),c(8,Qn,3,6,"a",4),w(9,"async"),s()()(),G()),e&2){let t,n=a(2);r(4),m(n.displayValues.comment?4:-1),r(2),v(" ",n.displayValues.id," "),r(2),m((t=(t=X(9,3,n.service.metadata))==null||t.user==null?null:t.user.globalRole)?8:-1,t)}}function Jn(e,o){if(e&1&&(l(0,"ion-footer",0),c(1,Yn,10,5,"ng-container",1),s()),e&2){let t=a();r(),m(t.user&&t.edge&&t.displayValues?1:-1)}}var lr=(()=>{class e{constructor(t,n){this.service=t,this.title=n,this.isSmartPhone=this.service.isSmartphoneResolution,this.user=null,this.edge=null,this.displayValues=null,this.isAtLeastOwner=null,R(()=>{let i=this.service.currentEdge();if(!i){this.edge=null;return}this.edge=i,this.setDisplayValues(i)})}static getDisplayValues(t,n){let i={comment:"",id:"",version:n.version};switch(Ot.backend){case"OpenEMS Backend":nt.isAtLeast(t.globalRole,nt.OWNER)&&t.hasMultipleEdges&&(i.comment=n?.comment),i.id=n.id;break;case"OpenEMS Edge":i.id=Ot.edgeShortName;break}return i}setDisplayValues(t){this.service.metadata.pipe(ae(n=>!!n)).subscribe(n=>{this.user=n.user;let i=Ot.edgeShortName;t&&(this.displayValues=e.getDisplayValues(this.user,t),this.user.hasMultipleEdges&&(i+=" | "+t.id)),this.title.setTitle(i)})}static{this.\u0275fac=function(n){return new(n||e)(u(j),u(Te))}}static{this.\u0275cmp=f({type:e,selectors:[["oe-footer"]],hostVars:1,hostBindings:function(n,i){n&2&&de("data-isSmartPhone",i.isSmartPhone)},standalone:!1,decls:1,vars:1,consts:[[2,"--background","var(--ion-color-toolbar-primary)"],["lines","none"],[2,"background-color","var(--ion-color-toolbar-primary)","color","var(--ion-color-primary-contrast)"],["size","12"],[2,"color","var(--ion-color-primary-contrast)",3,"routerLink"]],template:function(n,i){n&1&&c(0,Jn,2,1,"ion-footer",0),n&2&&m(i.service.isSmartphoneResolution?-1:0)},dependencies:[Dt,Ge,Oe,Gt,Ye,we,be,cn],styles:["[data-isSmartPhone=true][_nghost-%COMP%]{position:relative}[data-isSmartPhone=false][_nghost-%COMP%]{position:sticky;bottom:0;width:100%;font-size:14px!important}[data-isSmartPhone=false][_nghost-%COMP%]   :is(ion-row[_ngcontent-%COMP%]){text-align:center}[data-isSmartPhone=false][_nghost-%COMP%]   :is(ion-item[_ngcontent-%COMP%]){font-size:inherit}"]})}}return e})();var vn=(()=>{class e{constructor(){this.FALLBACK_IMG_URL="assets/img/image-not-found.png"}onImgError(t){let n=t.target;n.src=this.FALLBACK_IMG_URL}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=f({type:e,selectors:[["oe-img"]],inputs:{img:"img"},decls:1,vars:1,consts:[[2,"object-fit","contain",3,"ionError","src"]],template:function(n,i){n&1&&(l(0,"ion-img",0),h("ionError",function(g){return i.onImgError(g)}),s()),n&2&&d("src",(i.img==null?null:i.img.url)??i.FALLBACK_IMG_URL)},dependencies:[at,Re],encapsulation:2})}}return e})();var ti=[[["","button",""]],"*"],ei=["[button]","*"];function ni(e,o){if(e&1&&(l(0,"ion-button",11),C(1,"ion-icon",12),s()),e&2){let t=o.$implicit;d("href",t.url),r(),d("name",(t.icon==null?null:t.icon.name)??"help-circle-outline")("color",(t.icon==null?null:t.icon.color)??"light")("size",(t.icon==null?null:t.icon.size)??"medium")}}function ii(e,o){if(e&1&&D(0,ni,2,4,"ion-button",11,H),e&2){let t=a(2);A(t.toolbarButtons)}}function oi(e,o){if(e&1){let t=I();l(0,"ion-button",13),h("click",function(){y(t);let i=a(2);return b(i.toolbarButtons==null?null:i.toolbarButtons.callback())}),C(1,"ion-icon",12),s()}if(e&2){let t=a(2);d("href",t.toolbarButtons==null?null:t.toolbarButtons.url),r(),d("name",(t.toolbarButtons.icon==null?null:t.toolbarButtons.icon.name)??"help-circle-outline")("color",(t.toolbarButtons.icon==null?null:t.toolbarButtons.icon.color)??"dark")("size",(t.toolbarButtons.icon==null?null:t.toolbarButtons.icon.size)??"medium")}}function ri(e,o){if(e&1&&(c(0,ii,2,0),w(1,"typeof"),wt(2,oi,2,4,"ion-button",11)),e&2){let t=a();m(X(1,1,t.toolbarButtons)!=="Object"&&t.toolbarButtons.length>0?0:2)}}function ai(e,o){if(e&1&&C(0,"oe-help-button",4),e&2){let t=a();d("key",t.helpKey)("useDefaultPrefix",t.useDefaultPrefix)}}function li(e,o){e&1&&z(0)}function si(e,o){if(e&1&&(l(0,"form",8),L(1,li,1,0,"ng-container",14),s()),e&2){let t=a(),n=U(14);d("formGroup",t.formGroup),r(),d("ngTemplateOutlet",n)}}function ci(e,o){e&1&&z(0)}function mi(e,o){if(e&1&&(l(0,"div",9),L(1,ci,1,0,"ng-container",14),s()),e&2){a();let t=U(14);r(),d("ngTemplateOutlet",t)}}function di(e,o){e&1&&N(0,1)}function pi(e,o){if(e&1){let t=I();l(0,"ion-fab",10)(1,"ion-fab-button",15),h("click",function(){y(t);let i=a();return b(i.applyChanges())}),C(2,"ion-icon",16),s()()}if(e&2){let t=a();d("horizontal",t.service.isSmartphoneResolution?"end":"center")}}var _r=(()=>{class e{constructor(t,n,i,p){this.modalController=t,this.websocket=n,this.service=i,this.translate=p,this.component=null,this.formGroup=new kt({}),this.toolbarButtons=null,this.helpKey=null,this.useDefaultPrefix=!0,this.Role=nt,this.edge=null,this.service.getCurrentEdge().then(g=>this.edge=g)}applyChanges(){return P(this,null,function*(){let t=[];this.service.startSpinner("spinner");for(let n in this.formGroup.controls){let i=this.formGroup.controls[n];this.formGroup.controls[n],!i.pristine&&t.push({name:n,value:this.formGroup.value[n]})}this.edge&&this.edge.updateComponentConfig(this.websocket,this.component.id,t).then(()=>{this.service.toast(this.translate.instant("GENERAL.CHANGE_ACCEPTED"),"success")}).catch(n=>{this.service.toast(this.translate.instant("GENERAL.CHANGE_FAILED")+`
`+n.error.message,"danger")}).finally(()=>this.service.stopSpinner("spinner")),this.formGroup.markAsPristine()})}static{this.\u0275fac=function(n){return new(n||e)(u(K),u(ot),u(j),u(_t))}}static{this.\u0275cmp=f({type:e,selectors:[["oe-modal"]],inputs:{title:"title",component:"component",formGroup:"formGroup",toolbarButtons:"toolbarButtons",helpKey:"helpKey",useDefaultPrefix:"useDefaultPrefix"},standalone:!1,ngContentSelectors:ei,decls:16,vars:6,consts:[["contentTpl",""],[2,"--background","var(--ion-color-toolbar-primary)","color","var(--ion-title-color)"],["translate","",2,"color","var(--ion-title-color)"],["slot","end"],[3,"key","useDefaultPrefix"],["tabindex","0",3,"keydown.enter","click"],["name","close-outline","size","medium",2,"color","var(--ion-title-color)"],[2,"font-size","1em"],[2,"padding-left","5%","padding-right","5%","padding-top","2%","position","absolute","overflow-y","auto","overflow-x","hidden","height","88%","width","100%","padding-bottom","10%",3,"formGroup"],[2,"padding-left","5%","padding-right","5%","padding-bottom","10%","padding-top","2%","position","absolute","overflow-y","auto","overflow-x","hidden","height","88%","width","100%"],["vertical","bottom",2,"position","fixed",3,"horizontal"],["tabindex","0","target","_blank",3,"href"],[3,"name","color","size"],["tabindex","0","target","_blank",3,"click","href"],[4,"ngTemplateOutlet"],[3,"click"],["size","large","name","checkmark-circle-outline"]],template:function(n,i){if(n&1){let p=I();O(ti),l(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-title",2),_(3),s(),l(4,"ion-buttons",3),c(5,ri,3,3),N(6),c(7,ai,1,2,"oe-help-button",4),l(8,"ion-button",5),h("keydown.enter",function(){return y(p),b(i.modalController.dismiss())})("click",function(){return y(p),b(i.modalController.dismiss())}),C(9,"ion-icon",6),s()()()(),l(10,"ion-content",7),c(11,si,2,2,"form",8),c(12,mi,2,1,"div",9),L(13,di,1,0,"ng-template",null,0,Y),c(15,pi,3,1,"ion-fab",10),s()}n&2&&(r(3),S(i.title),r(2),m(i.toolbarButtons!==null?5:-1),r(2),m(i.helpKey?7:-1),r(4),m(i.formGroup?11:-1),r(),m(i.formGroup?-1:12),r(3),m(i.formGroup!=null&&i.formGroup.dirty?15:-1))},dependencies:[pt,Z,tt,De,Ae,ft,At,Vt,Pt,E,qe,Qe,J,tn,zt,Ht],styles:["[_nghost-%COMP%]{height:100%;font-size:.9em}"]})}}return e})();var q=(()=>{class e{constructor(t,n,i,p,g,M,V){this.websocket=t,this.route=n,this.service=i,this.modalCtrl=p,this.translate=g,this.formBuilder=M,this.ref=V,this.component=null,this.converter=Zt.TO_STRING,this.filter=vt.NO_FILTER,this.roleIsAtLeast=nt.GUEST,this.displayValue=null,this.displayName=null,this.edge=null,this.config=null,this.stopOnDestroy=new It,this.isAllowedToBeSeen=!0,this.show=!0,this.Role=nt,this.Utils=Rt,this.Converter=Zt,this.selector=jt(),V.detach(),setInterval(()=>{this.ref.detectChanges()},0)}set name(t){typeof t=="object"?(this.subscribe(t.channel),this._name=t.converter):this._name=t}set channelAddress(t){t&&this.subscribe(rt.fromString(t))}ngOnChanges(){this.setValue(this.value)}ngOnInit(){this.service.getCurrentEdge().then(t=>{this.service.getConfig().then(n=>{this.edge=t,this.config=n;let i=[...this.getChannelAddresses()];typeof this.name=="object"&&i.push(this.name.channel);let p=this.getChannelIds();for(let g of p)i.push(new rt(this.component.id,g));i.length!=0&&this.edge.subscribeChannels(this.websocket,this.selector,i),t.currentData.pipe(qt(this.stopOnDestroy)).subscribe(g=>{let M={};for(let V of i){let re=V.toString();M[re]=g.channel[re]}this.onCurrentData({allComponents:M})})})})}ngOnDestroy(){this.edge!=null&&this.edge.unsubscribeChannels(this.websocket,this.selector),this.stopOnDestroy.next(),this.stopOnDestroy.complete()}setValue(t){t=t??null,this.filter&&(this.show=this.filter(t)),typeof this._name=="function"?this.displayName=this._name(t):(this.displayName=this._name,this.converter&&(this.displayValue=this.converter(t)))}subscribe(t){this.service.getCurrentEdge().then(n=>{this.edge=n,this.edge.roleIsAtLeast(this.roleIsAtLeast)?(this.isAllowedToBeSeen=!0,n.subscribeChannels(this.websocket,this.selector,[t]),n.currentData.pipe(qt(this.stopOnDestroy)).subscribe(i=>{i.channel[t.toString()]!=null&&this.setValue(i.channel[t.toString()])})):this.isAllowedToBeSeen=!1})}onCurrentData(t){}getChannelAddresses(){return[]}getFormGroup(){}getChannelIds(){return[]}static{this.\u0275fac=function(n){return new(n||e)(u(ot),u(Et),u(j),u(K),u(_t),u(Se),u(ve))}}static{this.\u0275dir=dt({type:e,inputs:{formGroup:"formGroup",component:"component",controlName:"controlName",converter:"converter",filter:"filter",value:"value",roleIsAtLeast:"roleIsAtLeast",name:"name",channelAddress:"channelAddress"},features:[Mt]})}}return e})();function ui(e,o){if(e&1&&C(0,"ion-icon",5),e&2){let t=a().$implicit,n=a();d("name",t.icon.name||"power-outline")("color",n.formGroup.controls[n.controlName].value===t.value?t.icon.color:"normal")("size",t.icon.size||"medium")}}function fi(e,o){if(e&1){let t=I();l(0,"ion-segment-button",3),h("click",function(){let i=y(t).$implicit;return b(i.callback)}),l(1,"ion-label",4),_(2),s(),c(3,ui,1,3,"ion-icon",5),s()}if(e&2){let t=o.$implicit;d("value",t.value)("ngStyle",t.style),r(2),S(t.name),r(),m(t.icon?3:-1)}}var Fr=(()=>{class e extends q{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=k(e)))(i||e)}})()}static{this.\u0275cmp=f({type:e,selectors:[["oe-modal-buttons"]],inputs:{buttons:"buttons"},standalone:!1,features:[F],decls:4,vars:2,consts:[[2,"padding-top","2%",3,"formGroup"],[3,"formControlName"],[3,"value","ngStyle"],[3,"click","value","ngStyle"],[2,"color","var(--ion-color-text)"],[2,"width","40px",3,"name","color","size"]],template:function(n,i){n&1&&(l(0,"form",0)(1,"ion-segment",1),D(2,fi,4,4,"ion-segment-button",2,H),s()()),n&2&&(d("formGroup",i.formGroup),r(),d("formControlName",i.controlName),r(),A(i.buttons))},dependencies:[pt,Nt,Z,tt,Ft,E,et,He,ze,Lt,ye],encapsulation:2})}}return e})();function _i(e,o){if(e&1&&(l(0,"ion-col",2),C(1,"ion-icon",4),s()),e&2){let t=a(2);d("size",t.icon?1:0),r(),d("color",(t.icon==null?null:t.icon.color)??"primary")("name",(t.icon==null?null:t.icon.name)??"information-outline")("size",(t.icon==null?null:t.icon.size)??"small")}}function Ci(e,o){e&1&&C(0,"br")}function hi(e,o){if(e&1&&(l(0,"div"),_(1),c(2,Ci,1,0,"br"),s()),e&2){let t=o.$implicit,n=a(3);Q(t.lineStyle),r(),v(" ",t.text," "),r(),m(n.info.length>1?2:-1)}}function gi(e,o){if(e&1&&D(0,hi,3,4,"div",3,H),e&2){let t=a(2);A(t.info)}}function vi(e,o){if(e&1&&(l(0,"div"),_(1),s()),e&2){let t=a(2);Q(t.lineStyle),r(),v(" ",t.info," ")}}function xi(e,o){if(e&1&&(l(0,"ion-row",1),c(1,_i,2,4,"ion-col",2),l(2,"ion-col",2),c(3,gi,2,0),w(4,"typeof"),wt(5,vi,2,3,"div",3),s()()),e&2){let t=a();Q(t.rowStyle),r(),m(t.icon?1:-1),r(),d("size",t.icon?11:12),r(),m(X(4,5,t.info)!=="string"?3:5)}}var Dr=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=f({type:e,selectors:[["oe-modal-info-line"]],inputs:{info:"info",icon:"icon",lineStyle:"lineStyle",rowStyle:"rowStyle"},standalone:!1,decls:1,vars:1,consts:[["size","12",1,"full_width",2,"display","flex","align-items","center","line-height","1.4","margin-top","2%",3,"style"],["size","12",1,"full_width",2,"display","flex","align-items","center","line-height","1.4","margin-top","2%"],[3,"size"],[3,"style"],[3,"color","name","size"]],template:function(n,i){n&1&&c(0,xi,6,7,"ion-row",0),n&2&&m(i.info?0:-1)},dependencies:[Dt,E,Gt,Ht],encapsulation:2})}}return e})();var yi=["*"];function bi(e,o){if(e&1&&_(0),e&2){let t=a(3);v(" ",t.displayName," ")}}function Ii(e,o){if(e&1&&(l(0,"td",6),B(1),_(2),G(),s()),e&2){let t=a(3);T("width",(t.leftColumnWidth??50)+"%"),r(2),S(t.displayValue)}}function Ti(e,o){if(e&1&&(l(0,"td",6),C(1,"ion-icon",7),s()),e&2){let t=a(3);T("width",(t.leftColumnWidth??50)+"%"),r(),d("name",(t.button.icon==null?null:t.button.icon.name)??"help-circle-outline")("color",(t.button.icon==null?null:t.button.icon.color)??"light")("size",(t.button.icon==null?null:t.button.icon.size)??"medium")}}function Mi(e,o){if(e&1&&(l(0,"td",8)(1,"ion-item"),C(2,"ion-input",12),s()()),e&2){let t=a(4);d("formGroup",t.formGroup),r(2),d("label",St("\xA0",(t.control==null||t.control.properties==null?null:t.control.properties.unit)??"W","\xA0"))("formControlName",t.controlName)}}function wi(e,o){if(e&1){let t=I();l(0,"td",13)(1,"ion-toggle",14),h("keydown.enter",function(i){y(t);let p=a(4);return b(p.toggleOnEnter(i,p.controlName))}),s()()}if(e&2){let t=a(4);Q(t.service.isSmartphoneResolution?"transform: scale(0.7)":""),d("formGroup",t.formGroup),r(),d("formControlName",t.controlName)}}function Si(e,o){if(e&1&&(l(0,"ion-select-option",16),_(1),s()),e&2){let t=o.$implicit;d("value",t.value),r(),v(" ",t.name," ")}}function Ei(e,o){if(e&1&&(l(0,"ion-select",15),w(1,"translate"),w(2,"translate"),D(3,Si,2,2,"ion-select-option",16,H),s()),e&2){let t=a(5);d("formControlName",t.controlName)("okText",X(1,3,"GENERAL.OK"))("cancelText",X(2,5,"GENERAL.CANCEL")),r(3),A(t.control.options)}}function Ni(e,o){if(e&1&&(l(0,"td",10),c(1,Ei,5,7,"ion-select",15),s()),e&2){let t=a(4);d("formGroup",t.formGroup),r(),m(t.control.options?1:-1)}}function ki(e,o){if(e&1&&(l(0,"td",13),B(1),_(2),w(3,"converter"),G(),s()),e&2){let t=a(4);T("width",100-(t.leftColumnWidth??50)+"%"),d("formGroup",t.formGroup),r(2),v("",$(3,4,t.formGroup.controls[t.controlName].value,t.control.valueConverter)," ")}}function Fi(e,o){if(e&1&&(c(0,Mi,3,4,"td",8),c(1,wi,2,4,"td",9),c(2,Ni,2,2,"td",10),c(3,ki,4,7,"td",11)),e&2){let t=a(3);m(t.control.type==="INPUT"?0:-1),r(),m(t.control.type==="TOGGLE"?1:-1),r(),m(t.control.type==="SELECT"?2:-1),r(),m(t.control.type==="TEXT"?3:-1)}}function Li(e,o){e&1&&z(0)}function Di(e,o){if(e&1&&(l(0,"td",6),N(1),s()),e&2){let t=a(3);T("width",(t.leftColumnWidth??50)+"%")}}function Ai(e,o){if(e&1&&(l(0,"tr")(1,"td",3),c(2,bi,1,1),s(),c(3,Ii,3,3,"td",4),c(4,Ti,2,5,"td",4),c(5,Fi,4,4),L(6,Li,1,0,"ng-container",5)(7,Di,2,2,"ng-template",null,0,Y),s()),e&2){let t=U(8),n=a(2);T("text-indent",n.textIndent),r(),T("width",(n.leftColumnWidth??50)+"%"),r(),m(n.displayName?2:-1),r(),m(n.displayValue?3:-1),r(),m(n.button?4:-1),r(),m(n.formGroup&&n.control?5:-1),r(),d("ngTemplateOutlet",t)}}function Vi(e,o){if(e&1&&(_(0),w(1,"unitvalue")),e&2){let t=a(4);v(" ",$(1,1,t.control.properties.tickMin,t.control.properties.unit)," ")}}function Pi(e,o){if(e&1&&(_(0),w(1,"converter")),e&2){let t=a(4);v(" ",$(1,1,t.control.properties.tickMin,t.control.properties.tickFormatter?t.control.properties.tickFormatter:null)," ")}}function Bi(e,o){if(e&1&&(_(0),w(1,"unitvalue")),e&2){let t=a(4);v(" ",$(1,1,t.control.properties.tickMax,t.control.properties.unit)," ")}}function Gi(e,o){if(e&1&&(_(0),w(1,"converter")),e&2){let t=a(4);v(" ",$(1,1,t.control.properties.tickMax,t.control.properties.tickFormatter?t.control.properties.tickFormatter:null)," ")}}function Oi(e,o){if(e&1&&(l(0,"td",17),B(1,10),l(2,"ion-range",18)(3,"ion-label",19),c(4,Vi,2,4)(5,Pi,2,4),s(),l(6,"ion-label",20),c(7,Bi,2,4)(8,Gi,2,4),s()(),G(),s()),e&2){let t=a(3);r(),d("formGroup",t.formGroup),r(),d("min",t.control.properties.tickMin??1)("max",t.control.properties.tickMax??100)("step",t.control.properties.step??1)("formControlName",t.controlName)("pinFormatter",t.control.properties.pinFormatter??t.DEFAULT_PIN_FORMATTER)("pin",!0)("snaps",(t.control.properties==null?null:t.control.properties.snaps)??!1),r(2),m(t.control.properties.unit?4:5),r(3),m(t.control.properties.unit?7:8)}}function Ri(e,o){if(e&1&&(l(0,"tr"),c(1,Oi,9,10,"td",17),s()),e&2){let t=a(2);r(),m((t.control==null?null:t.control.type)==="RANGE"?1:-1)}}function ji(e,o){if(e&1&&(l(0,"table",1),c(1,Ai,9,9,"tr",2),c(2,Ri,2,1,"tr"),s()),e&2){let t=a();r(),m(t.textIndent?1:-1),r(),m(t.formGroup?2:-1)}}var yn=(()=>{class e extends q{constructor(){super(...arguments),this.button=null,this.textIndent=Ut.NONE,this.DEFAULT_PIN_FORMATTER=t=>t}toggleOnEnter(t,n){let i=this.formGroup.get(n);i&&(i.setValue(!i.value),t.preventDefault())}selectOnEnter(t,n){let i=this.formGroup.get(n);i&&(i.setValue(!i.value),t.preventDefault())}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=k(e)))(i||e)}})()}static{this.\u0275cmp=f({type:e,selectors:[["oe-modal-line"]],inputs:{leftColumnWidth:"leftColumnWidth",button:"button",control:"control",textIndent:"textIndent"},standalone:!1,features:[F],ngContentSelectors:yi,decls:1,vars:1,consts:[["contentTpl",""],[1,"full_width",2,"line-height","1.4","margin-top","0.5%"],[3,"text-indent"],[1,"align_left"],[1,"align_right",3,"width"],[4,"ngTemplateOutlet"],[1,"align_right"],[3,"name","color","size"],[1,"align_right",2,"width","30%",3,"formGroup"],[1,"align_right",3,"formGroup","style"],[3,"formGroup"],[1,"align_right",3,"width","formGroup"],["type","number","tabindex","0","label-placement","floating",1,"regularFont",2,"text-align","right",3,"formControlName","label"],[1,"align_right",3,"formGroup"],["button","","tabindex","0","mode","md",3,"keydown.enter","formControlName"],["interface","popover",2,"text-align","end",3,"formControlName","okText","cancelText"],[3,"value"],[2,"width","100%"],["color","dark","pin","true","debounce","500",2,"padding-top","8px",3,"min","max","step","formControlName","pinFormatter","pin","snaps"],["slot","start"],["slot","end"]],template:function(n,i){n&1&&(O(),c(0,ji,3,2,"table",1)),n&2&&m(i.isAllowedToBeSeen&&i.show?0:-1)},dependencies:[Nt,Z,tt,Ft,E,je,Bt,et,We,Ue,$e,Xe,Ee,Ne,Lt,J,Wt,sn,en],encapsulation:2})}}return e})(),Ut=(function(e){return e.NONE="0%",e.SINGLE="5%",e.DOUBLE="10%",e})(Ut||{});function Hi(e,o){if(e&1&&(l(0,"td",0)(1,"span",1),_(2),s()()),e&2){let t=a();r(2),v("\xA0\xA0",t.displayValue)}}var bn=(()=>{class e extends q{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=k(e)))(i||e)}})()}static{this.\u0275cmp=f({type:e,selectors:[["oe-modal-line-item"]],standalone:!1,features:[F],decls:1,vars:1,consts:[[2,"width","fit-content","display","inline","margin-right","0%","text-align","end"],[2,"width","fit-content"]],template:function(n,i){n&1&&c(0,Hi,3,1,"td",0),n&2&&m(i.isAllowedToBeSeen&&i.show&&i.displayValue?0:-1)},encapsulation:2})}}return e})();function Ui(e,o){if(e&1&&(l(0,"oe-modal-line",0),C(1,"oe-modal-line-item",1)(2,"oe-modal-line-item",1)(3,"oe-modal-line-item",2),s()),e&2){let t=o.$implicit,n=a();d("name",t.name)("textIndent",n.TextIndentation.SINGLE),r(),d("channelAddress",n.component.id+"/Voltage"+t.key)("roleIsAtLeast",n.Role.INSTALLER)("converter",n.Converter.VOLTAGE_IN_MILLIVOLT_TO_VOLT),r(),d("channelAddress",n.component.id+"/Current"+t.key)("roleIsAtLeast",n.Role.INSTALLER)("converter",n.Converter.CURRENT_IN_MILLIAMPERE_TO_ABSOLUTE_AMPERE),r(),d("channelAddress",n.component.id+"/ActivePower"+t.key)("converter",n.CONVERT_TO_POSITIVE_WATT)}}var Hr=(()=>{class e extends q{constructor(){super(...arguments),this.TextIndentation=Ut,this.phases=[{key:"L1",name:""},{key:"L2",name:""},{key:"L3",name:""}],this.setTranslatedName=t=>"",this.CONVERT_TO_POSITIVE_WATT=t=>{let n=(Jt.getByKey(localStorage.LANGUAGE)??Jt.DEFAULT).i18nLocaleKey;return t=Rt.absSafely(t)??0,xe(t,n,"1.0-0")+" W"}}getChannelAddresses(){let t=[];for(let n of this.phases)t.push(rt.fromString(this.component.id+"/ActivePower"+n.key));return t}onCurrentData(t){for(let n of this.phases){let i=t.allComponents[this.component.id+"/ActivePower"+n.key];n.name=this.translate.instant("GENERAL.PHASE")+" "+n.key+this.setTranslatedName(i)}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=k(e)))(i||e)}})()}static{this.\u0275cmp=f({type:e,selectors:[["oe-modal-meter-phases"]],inputs:{setTranslatedName:"setTranslatedName"},standalone:!1,features:[F],decls:2,vars:0,consts:[[3,"name","textIndent"],[3,"channelAddress","roleIsAtLeast","converter"],[3,"channelAddress","converter"]],template:function(n,i){n&1&&D(0,Ui,4,10,"oe-modal-line",0,H),n&2&&A(i.phases)},dependencies:[yn,bn],encapsulation:2})}}return e})();function $i(e,o){if(e&1&&_(0),e&2){let t=a(3);v(" ",t.displayName," ")}}function Ki(e,o){if(e&1&&(l(0,"td",4),B(1),_(2),G(),s()),e&2){let t=a(3);T("width",(t.leftColumnWidth??50)+"%"),r(2),S(t.displayValue)}}function qi(e,o){if(e&1&&(l(0,"tr")(1,"td",2),c(2,$i,1,1),s(),c(3,Ki,3,3,"td",3),s()),e&2){let t=a(2);T("text-indent",t.textIndent),r(),T("width",(t.leftColumnWidth??50)+"%"),r(),m(t.displayName?2:-1),r(),m(t.displayValue?3:-1)}}function Xi(e,o){if(e&1&&(l(0,"table",0),c(1,qi,4,6,"tr",1),s()),e&2){let t=a();r(),m(t.textIndent?1:-1)}}var $r=(()=>{class e extends q{constructor(){super(...arguments),this.textIndent=In.NONE,this.shouldShow=!1,this._filters=null}set channelsToSubscribe(t){this.channels=t}set filters(t){this._filters=t}getChannelAddresses(){return this.channels}onCurrentData(t){this.shouldShow=this._filters!==null&&typeof this._filters=="function"?this._filters(t):!0,this.displayValue=this.valueCallback(t)}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=k(e)))(i||e)}})()}static{this.\u0275cmp=f({type:e,selectors:[["oe-modal-value-line"]],inputs:{leftColumnWidth:"leftColumnWidth",textIndent:"textIndent",valueCallback:"valueCallback",channelsToSubscribe:"channelsToSubscribe",filters:"filters"},standalone:!1,features:[F],decls:1,vars:1,consts:[[1,"full_width",2,"line-height","1.4","margin-top","0.5%"],[3,"text-indent"],[1,"align_left"],[1,"align_right",3,"width"],[1,"align_right"]],template:function(n,i){n&1&&c(0,Xi,2,1,"table",0),n&2&&m(i.shouldShow&&i.isAllowedToBeSeen&&i.show?0:-1)},encapsulation:2})}}return e})(),In=(function(e){return e.NONE="0%",e.SINGLE="5%",e.DOUBLE="10%",e})(In||{});function Qi(e,o){e&1&&C(0,"div",0)}function Yi(e,o){if(e&1&&(B(0),c(1,Qi,1,0,"div",0),G()),e&2){let t=a();r(),m(t.index!==t.components.length-1?1:-1)}}function Ji(e,o){e&1&&C(0,"div",0)}function Zi(e,o){if(e&1&&c(0,Ji,1,0,"div",0),e&2){let t=a();m((t.components==null?null:t.components.length)!==1?0:-1)}}var qr=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=f({type:e,selectors:[["oe-modal-horizontal-line"]],inputs:{components:"components",index:"index"},standalone:!1,decls:2,vars:1,consts:[[2,"border-bottom","1px solid lightgray","opacity","0.2","width","110%","margin-top","2%","margin-bottom","2%","margin-left","-5%"]],template:function(n,i){n&1&&c(0,Yi,2,1,"ng-container")(1,Zi,1,1),n&2&&m(i.index&&(i.components==null?null:i.components.length)!==1?0:1)},encapsulation:2})}}return e})();var Tn=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=mt({type:e})}static{this.\u0275inj=st({imports:[ut,Qt,at,ht,Ct,Yt,zt,vn]})}}return e})(),$t=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=mt({type:e})}static{this.\u0275inj=st({imports:[ht,at,ut,gt,Qt,Yt,Ct,Tn,Tn]})}}return e})();var to=(e,o)=>o.id;function eo(e,o){if(e&1&&(l(0,"ion-text",3),_(1),s()),e&2){let t=a(),n=t.$implicit,i=t.$index,p=t.$count;d("color",i===p-1?"primary":"medium"),r(),S(n.label)}}function no(e,o){if(e&1&&C(0,"ion-icon",4),e&2){let t=a(3);d("name","home-outline")("color",t.currentlyActive?"primary":"medium")}}function io(e,o){if(e&1){let t=I();l(0,"ion-breadcrumb",2),h("keydown.enter",function(){let i=y(t),p=i.$implicit,g=i.$index,M=i.$count,V=a(2);return b(V.navigateTo(p,g!==M-1))})("click",function(){let i=y(t),p=i.$implicit,g=i.$index,M=i.$count,V=a(2);return b(V.navigateTo(p,g!==M-1))}),c(1,eo,2,2,"ion-text",3),c(2,no,1,2,"ion-icon",4),s()}if(e&2){let t=o.$implicit,n=o.$index,i=o.$count;d("active",n===i-1),r(),m(t.mode==="label"?1:-1),r(),m(t.mode==="icon"?2:-1)}}function oo(e,o){if(e&1&&(l(0,"ion-breadcrumbs",0),D(1,io,3,3,"ion-breadcrumb",1,to),s()),e&2){let t=a();r(),A(t.breadCrumbs())}}var Kt=(()=>{class e{constructor(t,n){this.navigationService=t,this.routeService=n,this.navigate=new ct,this.breadCrumbs=Tt([]),this.isVisible=!1,R(()=>{let i=this.navigationService.currentNode(),p=[...i?.getParents()??[]];p?.length>=1&&p.push(i),this.breadCrumbs.set(p)})}navigateTo(t,n){return P(this,null,function*(){n&&this.navigate.emit(t)})}static{this.\u0275fac=function(n){return new(n||e)(u(it),u(nn))}}static{this.\u0275cmp=f({type:e,selectors:[["oe-navigation-breadcrumbs"]],outputs:{navigate:"navigate"},standalone:!1,decls:1,vars:1,consts:[["maxItems","3"],["tabindex","0","color","primary",3,"active"],["tabindex","0","color","primary",3,"keydown.enter","click","active"],[3,"color"],[3,"name","color"]],template:function(n,i){n&1&&c(0,oo,3,0,"ion-breadcrumbs",0),n&2&&m(i.breadCrumbs().length>0?0:-1)},dependencies:[Fe,Le,E,Ke],encapsulation:2})}}return e})();function ro(e,o){if(e&1){let t=I();l(0,"ion-chip",1),h("keydown.enter",function(){let i=y(t).$implicit,p=a();return b(p.navigateTo(i))})("click",function(){let i=y(t).$implicit,p=a();return b(p.navigateTo(i))}),C(1,"ion-icon",2),l(2,"ion-label"),_(3),s()()}if(e&2){let t=o.$implicit;r(),d("name",(t.icon==null?null:t.icon.name)??"help-outline")("color",(t.icon==null?null:t.icon.color)??"medium")("size",(t.icon==null?null:t.icon.size)??"small"),r(2),S(t.label)}}var wn=(()=>{class e{constructor(t){this.navigationService=t,this.navigate=new ct,this.children=[],this.isVisible=!1,R(()=>{let n=t.currentNode();this.children=n?.getChildren()??[],this.isVisible=this.children.length>0})}navigateTo(t){return P(this,null,function*(){this.navigate.emit(t)})}static{this.\u0275fac=function(n){return new(n||e)(u(it))}}static{this.\u0275cmp=f({type:e,selectors:[["oe-navigation-chips"]],outputs:{navigate:"navigate"},standalone:!1,decls:2,vars:0,consts:[["tabindex","0",2,"background","var(--ion-background-color-card-header)"],["tabindex","0",2,"background","var(--ion-background-color-card-header)",3,"keydown.enter","click"],[3,"name","color","size"]],template:function(n,i){n&1&&D(0,ro,4,4,"ion-chip",0,pe),n&2&&A(i.children)},dependencies:[Be,E,et],encapsulation:2})}}return e})();var lo=["modal"],so=e=>[.05,e,.9];function co(e,o){if(e&1){let t=I();l(0,"ion-content",3)(1,"oe-navigation-breadcrumbs",4),h("navigate",function(i){y(t);let p=a(2);return b(p.navigateTo(i,!0))}),s(),l(2,"oe-navigation-chips",4),h("navigate",function(i){y(t);let p=a(2);return b(p.navigateTo(i,!0))}),s()()}}function mo(e,o){if(e&1){let t=I();l(0,"ion-modal",2,0),h("ionBreakpointDidChange",function(i){y(t);let p=a();return b(p.onBreakpointDidChange(i))}),L(2,co,3,0,"ng-template"),s()}if(e&2){let t=a();d("isOpen",!0)("initialBreakpoint",t.initialBreakPoint)("breakpoints",he(5,so,t.initialBreakPoint))("backdropDismiss",!1)("backdropBreakpoint",t.initialBreakPoint)}}var lt=class e{static{this.INITIAL_BREAKPOINT=.15}static{this.breakPoint=Tt(e.INITIAL_BREAKPOINT)}constructor(o){this.navigationService=o,this.modal=null,this.initialBreakPoint=e.INITIAL_BREAKPOINT,this.children=[],this.parents=[],this.isVisible=!0,R(()=>{o.currentNode()||this.navigationService.position.set("disabled"),this.isVisible=this.navigationService.position()==="bottom"})}navigateTo(o,t){return P(this,null,function*(){t&&(this.modal&&this.modal.setCurrentBreakpoint(this.initialBreakPoint),this.navigationService.navigateTo(o))})}onBreakpointDidChange(o){e.breakPoint.set(o.detail.breakpoint)}static{this.\u0275fac=function(t){return new(t||e)(u(it))}}static{this.\u0275cmp=f({type:e,selectors:[["oe-navigation"]],viewQuery:function(t,n){if(t&1&&ue(lo,5),t&2){let i;fe(i=_e())&&(n.modal=i.first)}},standalone:!1,decls:1,vars:1,consts:[["modal",""],["showBackdrop","true","focusTrap","false",2,"--box-shadow","0 0 0.25rem rgba(0,0,0,0.7)",3,"isOpen","initialBreakpoint","breakpoints","backdropDismiss","backdropBreakpoint"],["showBackdrop","true","focusTrap","false",2,"--box-shadow","0 0 0.25rem rgba(0,0,0,0.7)",3,"ionBreakpointDidChange","isOpen","initialBreakpoint","breakpoints","backdropDismiss","backdropBreakpoint"],[1,"ion-padding"],[3,"navigate"]],template:function(t,n){t&1&&c(0,mo,3,7,"ion-modal",1),t&2&&m(n.isVisible?0:-1)},dependencies:[ft,Je,wn,Kt],encapsulation:2})}};var bt;(function(e){function o(){let n=Array.from(document.querySelectorAll("ion-header")),i=Array.from(document.querySelectorAll("ion-footer")),p=n.reduce((M,V)=>M+V.clientHeight,0),g=i.reduce((M,V)=>M+V.clientHeight,0);return{header:p,footer:g}}e.getTotalHeaderFooterHeight=o;function t(n){let{header:i,footer:p}=e.getTotalHeaderFooterHeight();if(n==null||n=="disabled")return window.innerHeight-i-p;if(n==="bottom"){let g=window.innerHeight*lt.breakPoint();return window.innerHeight-i-p-g}return window.innerHeight-i-p}e.getViewHeight=t})(bt||(bt={}));var po=[[["","header",""]],"*"],uo=["[header]","*"];function fo(e,o){if(e&1){let t=I();l(0,"oe-navigation-breadcrumbs",3),h("navigate",function(i){y(t);let p=a();return b(p.navigationService.navigateTo(i))}),s()}}function _o(e,o){e&1&&z(0)}function Co(e,o){if(e&1){let t=I();l(0,"ion-fab",8)(1,"ion-fab-button",9),h("click",function(){y(t);let i=a(3);return b(i.applyChanges())}),C(2,"ion-icon",10),s()()}if(e&2){let t=a(3);d("horizontal",t.service.isSmartphoneResolution?"end":"center")}}function ho(e,o){if(e&1&&(l(0,"form",6),L(1,_o,1,0,"ng-container",7),c(2,Co,3,1,"ion-fab",8),s()),e&2){a();let t=U(4),n=a();T("height",n.contentHeight+"px"),d("formGroup",n.formGroup),r(),d("ngTemplateOutlet",t),r(),m(n.formGroup!=null&&n.formGroup.dirty?2:-1)}}function go(e,o){e&1&&z(0)}function vo(e,o){if(e&1&&(l(0,"div",11),L(1,go,1,0,"ng-container",7),s()),e&2){a();let t=U(4),n=a();T("height",n.contentHeight+"px"),r(),d("ngTemplateOutlet",t)}}function xo(e,o){e&1&&N(0,1,[1,"ion-padding"])}function yo(e,o){if(e&1&&(l(0,"ion-content",2),c(1,ho,3,5,"form",4),c(2,vo,2,3,"div",5),L(3,xo,1,0,"ng-template",null,0,Y),s()),e&2){let t=a();r(),m(t.formGroup&&t.contentHeight!==null?1:-1),r(),m(t.formGroup?-1:2)}}var Ua=(()=>{class e{constructor(t,n,i,p,g){this.modalController=t,this.service=n,this.navigationService=i,this.websocket=p,this.translate=g,this.component=null,this.formGroup=new kt({}),this.contentHeight=null,this.edge=null,this.service.getCurrentEdge().then(M=>this.edge=M),R(()=>{lt.breakPoint()>lt.INITIAL_BREAKPOINT||(this.contentHeight=bt.getViewHeight(ge(()=>this.navigationService.position())))})}applyChanges(){let t=[];this.service.startSpinner("spinner");for(let n in this.formGroup.controls){let i=this.formGroup.controls[n];this.formGroup.controls[n],!i.pristine&&t.push({name:n,value:this.formGroup.value[n]})}this.edge&&this.edge.updateComponentConfig(this.websocket,this.component.id,t).then(()=>{this.service.toast(this.translate.instant("GENERAL.CHANGE_ACCEPTED"),"success")}).catch(n=>{this.service.toast(this.translate.instant("GENERAL.CHANGE_FAILED")+`
`+n.error.message,"danger")}).finally(()=>this.service.stopSpinner("spinner")),this.formGroup.markAsPristine()}onDomChange(){this.contentHeight=bt.getViewHeight(this.navigationService.position())}static{this.\u0275fac=function(n){return new(n||e)(u(K),u(j),u(it),u(ot),u(_t))}}static{this.\u0275cmp=f({type:e,selectors:[["oe-navigation-view"]],inputs:{component:"component",formGroup:"formGroup"},standalone:!1,ngContentSelectors:uo,decls:4,vars:2,consts:[["contentTpl",""],[3,"ngDomChange"],[2,"font-size","1em"],[3,"navigate"],[1,"ion-padding",2,"position","absolute","overflow-y","auto","overflow-x","hidden","width","100%",3,"formGroup","height"],[2,"padding-left","5%","padding-right","5%","padding-bottom","10%","padding-top","2%","position","absolute","overflow-y","auto","overflow-x","hidden","width","100%",3,"height"],[1,"ion-padding",2,"position","absolute","overflow-y","auto","overflow-x","hidden","width","100%",3,"formGroup"],[4,"ngTemplateOutlet"],["vertical","bottom",1,"ion-padding-bottom",2,"display","flex",3,"horizontal"],[3,"click"],["size","large","name","checkmark-circle-outline"],[2,"padding-left","5%","padding-right","5%","padding-bottom","10%","padding-top","2%","position","absolute","overflow-y","auto","overflow-x","hidden","width","100%"]],template:function(n,i){n&1&&(O(po),l(0,"ion-header",1),h("ngDomChange",function(){return i.onDomChange()}),c(1,fo,1,0,"oe-navigation-breadcrumbs"),N(2),s(),c(3,yo,5,2,"ion-content",2)),n&2&&(r(),m(i.navigationService.position()==="left"?1:-1),r(2),m(i.contentHeight!==null?3:-1))},dependencies:[J,ft,At,Vt,Pt,E,pt,Z,tt,gn,Kt],styles:["[_nghost-%COMP%]{height:100%;font-size:.9em}[_nghost-%COMP%]   ion-grid[_ngcontent-%COMP%]{display:inline!important}"]})}}return e})();var Sn=class e{static{this.PREFIX="hide-notification-"}static{this.MAX_SHOW_DATE=new Date(2025,9,8)}static{this.THREE_DAYS_IN_S=3600*24*3}constructor(o){this.toastCtrl=o,this.text=null,this.id=null,this.hideMessage=!0}ngOnInit(){let o=localStorage.getItem(e.PREFIX+this.id),t=on(new Date,e.MAX_SHOW_DATE);if(t==!1&&o==null){this.hideMessage=!1,this.createToast();return}let n=ln.isDifferenceInSecondsGreaterThan(e.THREE_DAYS_IN_S,new Date,rn.stringToDate(o))==!1;this.hideMessage=t===!0?!0:n,this.createToast()}createToast(){return P(this,null,function*(){if(!this.text)return;if(!this.id){console.error("Id needs to be provided");return}if(this.hideMessage)return;let o=yield this.toastCtrl.create({translucent:!1,message:this.text,position:"bottom",buttons:[{icon:"close-outline",role:"cancel",side:"end"}],color:"primary",cssClass:"toast-top-close"});o.present(),this.styleToast(),yield o.onDidDismiss().then(()=>{localStorage.setItem(e.PREFIX+this.id,new Date().toISOString())})})}styleToast(){let o=document.querySelector("ion-toast");if(o==null)return;let t=o.shadowRoot,n=t?.querySelector(".toast-button-group")??null;if(n==null)return;n.style.alignSelf="flex-start",n.style.display="flex !important;";let i=t?.querySelector(".toast-container")??null;i!=null&&(i.style.backgroundColor="rgba(var(--ion-background-color-rgb), 0.2)")}static{this.\u0275fac=function(t){return new(t||e)(u(Ze))}}static{this.\u0275cmp=f({type:e,selectors:[["oe-notification"]],inputs:{text:"text",id:"id"},standalone:!1,decls:0,vars:0,template:function(t,n){},encapsulation:2})}};var En=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=mt({type:e})}static{this.\u0275inj=st({imports:[ht,at,Ct,ut,gt,$t,te,ee,$t,Cn,te,ee,Ct]})}}return e})(),Al=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=mt({type:e})}static{this.\u0275inj=st({imports:[En,Ie,_n,mn,dn,hn,un,pn,$t,ut,gt,En]})}}return e})();export{Wo as a,vt as b,Bo as c,Uo as d,qo as e,q as f,yn as g,Ut as h,wn as i,lt as j,bt as k,Ua as l,Fr as m,vn as n,_r as o,Dr as p,bn as q,Hr as r,$r as s,qr as t,Tn as u,$t as v,lr as w,Sn as x,En as y,Al as z};
