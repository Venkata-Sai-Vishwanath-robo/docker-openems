import{a as dt}from"./chunk-B5TTBQK4.js";import{d as rt,g as ft,h as ut,i as Et,j as y,k as R,m as x}from"./chunk-RQWSIHDL.js";import"./chunk-6SDHATKH.js";import{a as _t}from"./chunk-2OZBANFK.js";import"./chunk-GYAINRZU.js";import"./chunk-V6SQQYN5.js";import{$d as Z,$f as pt,A as F,Ca as j,Da as X,E as k,Ea as p,Ef as mt,F as W,Ff as d,Hb as J,Hc as S,Ma as V,N as Y,Qa as z,Ra as $,Se as b,Ue as nt,Uf as lt,V as m,Ve as at,Vf as A,Wf as ct,Xe as r,Ye as w,Ze as st,ba as I,ce as tt,da as v,dc as Q,ea as B,ee as et,eg as N,ge as it,ha as g,ie as ot,jb as K,jc as L,kb as q,mg as P,oa as _,qa as C,va as c,wa as M,xa as h,ya as T}from"./chunk-UEHZAF3Y.js";import"./chunk-TCWA4BEU.js";import"./chunk-HJTVDRW6.js";import"./chunk-YJIFWFWF.js";import"./chunk-QUJFQN2Y.js";import"./chunk-P3LHHAYW.js";import"./chunk-Y7WT5TFP.js";import"./chunk-JHMH7CMQ.js";import"./chunk-WVHTM5RI.js";import"./chunk-IN6HLDFE.js";import"./chunk-GIMG75PD.js";import"./chunk-IHO4TDRD.js";import"./chunk-4KCIDQZU.js";import"./chunk-7UI6JPU6.js";import"./chunk-J5AVGG2P.js";import"./chunk-VIYDSDQU.js";import"./chunk-F46NF3P5.js";import"./chunk-SAL3DLJT.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-EOGXKGKT.js";import"./chunk-CKP3SGE2.js";import"./chunk-RY6RMDSE.js";import"./chunk-OQDXQ3X5.js";function It(e,H){if(e&1&&(M(0,"table",1)(1,"tr")(2,"td",5),z(3),h()()()),e&2){let t=p();m(3),$(t.chartTitle)}}function Mt(e,H){if(e&1&&T(0,"canvas",4),e&2){let t=p();c("datasets",t.datasets)("labels",t.labels)("options",t.options)("type",t.chartType)}}var ht=(()=>{class e extends mt{static getChartData(t,i,o,f){return pt.assertIsDefined(t),{input:[{name:"Status",powerChannel:new N(t.id,"Status")},{name:"ForceOnStateTime",energyChannel:new N(t.id,"ForceOnStateTime")},{name:"LockStateTime",energyChannel:new N(t.id,"LockStateTime")},{name:"RecommendationStateTime",energyChannel:new N(t.id,"RecommendationStateTime")},{name:"RegularStateTime",energyChannel:new N(t.id,"RegularStateTime")}],output:l=>{let a=l;return o==="line"?[{name:i.instant("GENERAL.STATE"),converter:()=>a.Status?.map(n=>{let u=r.multiplySafely(n,1e3);return u!=null?r.addSafely(u,1):null}),color:d.Colors.RED,stack:0}]:(a=e.sanitizeData(l,f),[{name:i.instant("EDGE.INDEX.WIDGETS.HEAT_PUMP.LOCK"),nameSuffix:n=>n?.result.data[t.id+"/LockStateTime"],converter:()=>a.LockStateTime,color:d.Colors.DARK_GREY,stack:0},{name:i.instant("EDGE.INDEX.WIDGETS.HEAT_PUMP.NORMAL_OPERATION"),nameSuffix:n=>n?.result.data[t.id+"/RegularStateTime"],converter:()=>a.RegularStateTime,color:d.Colors.YELLOW,stack:0},{name:i.instant("EDGE.INDEX.WIDGETS.HEAT_PUMP.SWITCH_ON_REC"),nameSuffix:n=>n?.result.data[t.id+"/RecommendationStateTime"],converter:()=>a.RecommendationStateTime,color:d.Colors.ORANGE,stack:0},{name:i.instant("EDGE.INDEX.WIDGETS.HEAT_PUMP.SWITCH_ON_COM"),nameSuffix:n=>n?.result.data[t.id+"/ForceOnStateTime"],converter:()=>a.ForceOnStateTime,color:d.Colors.RED,stack:0}])},tooltip:{formatNumber:d.NumberFormat.NO_DECIMALS},yAxes:[{unit:o==="line"?w.HEAT_PUMP:w.TIME,position:"left",yAxisId:st.LEFT}]}}static{this.CONVERT_NUMBER_TO_BE_AT_MOST=(t,i)=>t==null?t:Math.min(t,i)}static sanitizeData(t,i){let l={},a=at.summarizeValuesByIndex(t).map(n=>r.multiplySafely(n,1e3));for(let n=0;n<Object.keys(t).length;n++){let[u,Nt]=Object.entries(t)[n],E=Nt.map(s=>r.multiplySafely(s,1e3));if(u!=="RegularStateTime"){l[u]=E;continue}switch(i){case b.PeriodString.MONTH:E=E.map((s,O)=>{if(s==null)return null;let D=r.orElse(r.subtractSafely(86400,a[O]),0);return e.CONVERT_NUMBER_TO_BE_AT_MOST(a[O]>86340?r.addSafely(s,D):s,86400)});break;case b.PeriodString.YEAR:E=E.map((s,O)=>{if(s==null)return null;let D=r.floorSafely(r.divideSafely(s,86400)),G=r.multiplySafely(D+1,86400),yt=r.orElse(r.subtractSafely(r.multiplySafely(D+1,86400),3600),G),Ot=r.subtractSafely(G,a[O]);return e.CONVERT_NUMBER_TO_BE_AT_MOST(a[O]>yt?r.addSafely(s,Ot):s,G)});break}l[u]=E}return l}getChartData(){return e.getChartData(this.component,this.translate,this.chartType,this.service.periodString)}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Y(e)))(o||e)}})()}static{this.\u0275cmp=v({type:e,selectors:[["controller-io-heatpump-chart"]],features:[g],decls:5,vars:6,consts:[[3,"response"],[1,"full_width"],["id","chart-area",1,"semi-transparent-background","ion-padding-top"],[3,"name"],["baseChart","",2,"padding-bottom","2vh",3,"datasets","labels","options","type"],[1,"ion-padding",2,"width","100%"]],template:function(i,o){i&1&&(T(0,"oe-history-data-error",0),_(1,It,4,1,"table",1),M(2,"div",2),T(3,"ngx-spinner",3),_(4,Mt,1,4,"canvas",4),h()),i&2&&(c("response",o.errorResponse),m(),C(o.chartTitle?1:-1),m(),V("height",o.getChartHeight(),"px"),m(),c("name",o.spinnerId),m(),C(o.loading?-1:4))},dependencies:[P,A,lt,rt,S,x,y,ut],encapsulation:2})}}return e})();var Tt={de:{LEGEND_DESCRIPTION:"Legende Betriebszustand"},en:{LEGEND_DESCRIPTION:"Legend operating status"}};function vt(e,H){if(e&1&&(T(0,"oe-chart-legend",2),K(1,"translate")),e&2){let t=p(2);c("description",t.STATES)("header",q(1,2,"LEGEND_DESCRIPTION"))}}function gt(e,H){if(e&1){let t=j();M(0,"oe-chart",0)(1,"controller-io-heatpump-chart",1),X("setChartConfig",function(o){k(t);let f=p();return W(f.setChartConfig(o))}),h(),_(2,vt,2,4,"oe-chart-legend",2),h()}if(e&2){let t=p();c("title",t.component.alias),m(),c("isOnlyChart",!0)("component",t.component),m(),C(t.chartType==="line"?2:-1)}}var St=(()=>{class e extends dt{constructor(t,i,o,f){super(t,i,o),this.service=t,this.route=i,this.modalCtrl=o,this.translate=f,this.STATES=`
    1.${this.translate.instant("EDGE.INDEX.WIDGETS.HEAT_PUMP.LOCK")}
    2.${this.translate.instant("EDGE.INDEX.WIDGETS.HEAT_PUMP.NORMAL_OPERATION")} 
    3.${this.translate.instant("EDGE.INDEX.WIDGETS.HEAT_PUMP.SWITCH_ON_REC")} 
    4.${this.translate.instant("EDGE.INDEX.WIDGETS.HEAT_PUMP.SWITCH_ON_COM")}
    `,this.chartType="line",nt.setAdditionalTranslationFile(Tt,this.translate).then(({lang:U,translations:l,shouldMerge:a})=>{this.translate.setTranslation(U,l,a)})}setChartConfig(t){this.chartType=t.chartType}static{this.\u0275fac=function(i){return new(i||e)(I(ct),I(Q),I(Z),I(et))}}static{this.\u0275cmp=v({type:e,selectors:[["controller-io-heatpump-overview"]],features:[g],decls:1,vars:1,consts:[[3,"title"],[3,"setChartConfig","isOnlyChart","component"],[3,"description","header"]],template:function(i,o){i&1&&_(0,gt,3,4,"oe-chart",0),i&2&&C(o.isInitialized?0:-1)},dependencies:[P,_t,S,ht,x,ft,Et,R,y,it],encapsulation:2})}}return e})();var At=[{path:"",component:St}],Te=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=B({type:e})}static{this.\u0275inj=F({imports:[S,J,tt,ot,R,L.forChild(At),y,A,L]})}}return e})();export{Te as HeatPumpModule};
